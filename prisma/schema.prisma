generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  name     String
  email    String @unique
  password String
  Cart     Cart[]
}

model Categories {
  id          String @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  description String
  menuItems   Menu[]
}

model Menu {
  id             String                @id @default(auto()) @map("_id") @db.ObjectId
  description    String
  name           String                @map("name")
  image_url      String
  rating         Int
  calories       Int
  protein        Int
  price          Float
  categoryId     String                @db.ObjectId
  category       Categories            @relation(fields: [categoryId], references: [id])
  customizations menu_Costumizations[]
  CartItem       CartItem[]
}

enum CustomizationType {
  topping
  side
  size
  crust
  bread
  spice
  base
  sauce
}

model Costumizations {
  id                    String                  @id @default(auto()) @map("_id") @db.ObjectId
  name                  String
  price                 Int
  type                  CustomizationType
  menus                 menu_Costumizations[]
  CartItemCustomization CartItemCustomization[]
}

model menu_Costumizations {
  id              String @id @default(auto()) @map("_id") @db.ObjectId
  menuId          String @db.ObjectId
  costumizationId String @db.ObjectId

  menu           Menu           @relation(fields: [menuId], references: [id])
  costumizations Costumizations @relation(fields: [costumizationId], references: [id])
}

model Cart {
  id        String     @id @default(auto()) @map("_id") @db.ObjectId
  userId    String     @db.ObjectId
  user      User       @relation(fields: [userId], references: [id])
  items     CartItem[]
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

model CartItem {
  id     String @id @default(auto()) @map("_id") @db.ObjectId
  cartId String @db.ObjectId
  cart   Cart   @relation(fields: [cartId], references: [id])

  menuId String @db.ObjectId
  menu   Menu   @relation(fields: [menuId], references: [id])

  quantity       Int                     @default(1)
  // Optional if you allow customizations on cart items
  customizations CartItemCustomization[]
}

model CartItemCustomization {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  cartItemId String   @db.ObjectId
  cartItem   CartItem @relation(fields: [cartItemId], references: [id])

  costumizationId String         @db.ObjectId
  costumization   Costumizations @relation(fields: [costumizationId], references: [id])
}
